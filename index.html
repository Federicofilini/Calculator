<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Сalculator</title>
    <link rel="icon" href="./favicon.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=ZCOOL+QingKe+HuangYou&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./index.css" />
    <link rel="stylesheet" href="./calc.js" />
  </head>
  <body>
    <div class="calc">
      <div class="radiator">
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
      </div>
      <div class="display-wrapper">
        <span class="line line-one"></span>
        <span class="line line-two"></span><span class="line line-three"></span
        ><span class="line line-four"></span>
        <div  class="calc-display">
          <span class="final-num" id="display">0</span>
          <div class="calc-display_cover"></div>
        </div>
      </div>
      <div class="calc-wrapper">
        <div class="top-buttons-aria">
          <div class="top-battons_zone aria">
            <button type="button" class="btn"><span>←→</span></button
            ><button type="button" class="btn calcBtn"><span>%</span></button
            ><button type="button" class="btn calcBtn"><span>√</span></button
            ><button type="button" class="btn"><span>1/X</span></button>
          </div>
          <div class="buttons-aria_swich">
            <span>Электроника МК-4</span>

            <div class="swich-btn-box">
              <input type="checkbox" id="swich-btn" />
              <label class="swich-btn" for="swich-btn"></label>
            </div>

            <div class="swich-btn-box">
              <input type="checkbox" id="swich-btn-two" />
              <label class="swich-btn" for="swich-btn-two"></label>
            </div>
          </div>
        </div>
        <div class="buttons-aria aria">
          <div class="buttons-section">
            <button type="button" class="btn">
              <span class="calcBtn">СП-1</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">СП-2</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">П1-</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">П2-</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">П1+</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">П2+</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">ХП</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">ПХ</span>
            </button>
          </div>
          <div class="buttons-middle-section aria">
            <button type="button" class="btn">
              <span class="calcBtn">7</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">8</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">9</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">4</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">5</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">6</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">1</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">2</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">3</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">0</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">,</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">/-/</span>
            </button>
          </div>
          <div class="buttons-section aria">
            <button type="button" class="btn btn-clean">
              <span class="btn-clean-span calcBtn" id="clearDisplay">C</span>
            </button>
            <button type="button" class="btn "><span id="cleanLastSign">CK</span></button>
            <button type="button" class="btn">
              <span class="calcBtn">-</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">÷</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">+</span>
            </button>
            <button type="button" class="btn">
              <span class="calcBtn">×</span>
            </button>
            <button type="button" class="btn btn-equals">
              <span class="btn-equals_span calcBtn" >=</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      let calcDisplay = document.getElementById("display");
      let checkboxOne = document.getElementById("swich-btn");
      checkboxOne.addEventListener("change", () => {
        if (checkboxOne.checked) {
          calcDisplay.style.fontFamily = "Trireme";
        } else {
          calcDisplay.style.fontFamily = "ZCOOL QingKe HuangYou";
        }
      });
    </script>
    <script>
      let swichBtnTwo = document.getElementById("swich-btn-two");
      let calcDisplayWriper = document.getElementsByClassName("calc-display") [0];
      swichBtnTwo.addEventListener("change", () => {
        if (swichBtnTwo.checked) {
          
          calcDisplay.style.color = "#c03519eb";
          calcDisplay.style.textShadow = "0 0 2px #ff2525eb, 0 0 3px #ff7f2fd2, 0 0 6px #fbb95d, 0 0 10px #f3d13d, 0 0 80px #f8f55f";
          calcDisplayWriper.style.boxShadow = "inset 0px 0px  5px #fa0101b0, inset 0px 0px 10px #ea3909ea,inset 0 0 30px #efa031";
        } else {
          
          calcDisplay.style.color = "#10ffb7eb";
          calcDisplay.style.textShadow = "0 0 2px #0c93c4, 0 0 3px #00ff00, 0 0 4px #5da7fb, 0 0 5px #00ff00, 0 0 80px #c0f7f1";
          calcDisplayWriper.style.boxShadow = "inset 0 0 5px #02430f, inset 0 0 10px #05f7bb,inset 0 0 20px #b2e5f6"; 
    
    

        }
      });
    </script>
    
    
   <script>
  // Глобальные переменные калькулятора
  var a = "";
  var b = "";
  var sign = "";
  var finish = false;

  // Массивы допустимых символов
  const digit = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", ","];
  // Добавляем "√" как один из операторов (у него унарная логика)
  const action = ["-", "+", "÷", "×", "%", "√"];
  
  // Элемент дисплея
  const display = document.getElementById("display");

  // Функция очистки (кнопка "C")
  function clearAll() {
    a = "";
    b = "";
    sign = "";
    finish = false;
    display.textContent = 0;
    console.log("Очистка: a =", a, "b =", b, "sign =", sign);
  }
  document.getElementById("clearDisplay").onclick = clearAll;

  // Вспомогательная функция: преобразование строки с запятой в число
  function parseNumber(str) {
    return parseFloat(str.replace(",", "."));
  }

  // Вспомогательная функция: форматирование числа, заменяя точку на запятую
  function formatNumber(num) {
    let str = num.toString();
    return str.includes(".") ? str.replace(".", ",") : str;
  }

  document.querySelectorAll(".calcBtn").forEach((button) => {
    button.addEventListener("click", (event) => {
      const key = event.target.textContent;
      console.log("Нажата кнопка:", key);

      // Если нажата цифра (или запятая)
      if (digit.includes(key)) {
        if (sign === "") {
          a += key;
          display.textContent = a;
          console.log("a:", a);
        } else {
          b += key;
          display.textContent = b;
          console.log("b:", b);
        }
        return; // Выходим после обработки цифры
      }

      // Если нажата кнопка оператора
      if (action.includes(key)) {
        // Если оператор "√" нажат, сразу устанавливаем его (как унарный оператор)
        if (key === "√") {
          if (a !== "") {
            sign = key;
            display.textContent = sign;
            console.log("Оператор выбран:", sign);
          } else {
            console.log("Сначала введите число.");
          }
          return;
        } else {
          if (a !== "") {
            sign = key;
            display.textContent = sign;
            console.log("Оператор выбран:", sign);
          } else {
            console.log("Сначала введите число.");
          }
          return;
        }
      }

      // Если нажата кнопка "="
      if (key === "=") {
  console.log("Начинаем вычисление:", a, sign, b);
  let result;
  if (sign === "√") {
    // Унарная операция: квадратный корень из a
    let numA = parseNumber(a);
    result = Math.sqrt(numA);
  } else if (sign === "%") {
    // Если b введено, считаем процент от a: a * b / 100
    // Если b пустое, считаем a/100
    if (b !== "") {
      let numA = parseNumber(a);
      let numB = parseNumber(b);
      result = numA * numB / 100;
    } else {
      let numA = parseNumber(a);
      result = numA / 100;
    }
  } else {
    // Обработка бинарных операций: +, -, ×, ÷
    let numA = parseNumber(a);
    let numB = parseNumber(b);
    switch (sign) {
      case "+":
        result = numA + numB;
        break;
      case "-":
        result = numA - numB;
        break;
      case "×":
        result = numA * numB;
        break;
      case "÷":
        result = numA / numB;
        break;
      default:
        console.log("Оператор не распознан:", sign);
        return;
    }
  }
  display.textContent = formatNumber(result);
  console.log("Результат вычисления:", result);
  // Обновляем переменные для продолжения вычислений
  a = result.toString();
  b = "";
  sign = "";
  finish = true;
  return;
      }
    });
  });
</script>

  <script>
    // Предполагается, что глобальные переменные a, b, sign и display уже объявлены в вашем коде:
    // var a = "";
    // var b = "";
    // var sign = "";
    // const display = document.getElementById("display");
    
    // Функция, которая удаляет последний символ из строки
    function removeLastChar(str) {
      return str.slice(0, -1);
    }
  
    // Назначаем обработчик события на кнопку "CK" (очистка последнего символа)
    document.getElementById("cleanLastSign").addEventListener("click", () => {
      console.log("Нажата кнопка CK (удаление последнего символа).");
      
      // Если оператор (sign) ещё не выбран, работаем с первым операндом (a)
      if (sign === "") {
        // Удаляем последний символ из a
        a = removeLastChar(a);
        // Обновляем дисплей. Если a стала пустой, показываем 0.
        display.textContent = a || "0";
        console.log("Обновлено a:", a);
      } else {
        // Если оператор выбран, значит, вводится второй операнд (b)
        if (b !== "") {
          // Если b не пустая, удаляем последний символ из b
          b = removeLastChar(b);
          // Обновляем дисплей – показываем b, если b не пустая, иначе показываем выбранный оператор
          display.textContent = b || sign;
          console.log("Обновлено b:", b);
        } else {
          // Если b пустая, но оператор выбран, значит, пользователь хочет удалить оператор
          sign = "";
          // Возвращаем отображение первого операнда
          display.textContent = a || "0";
          console.log("Удалён оператор. Значение a:", a);
        }
      }
    });
  </script>
  
  
    
  </body>
</html>
